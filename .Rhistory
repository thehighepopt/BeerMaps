phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,x)
}
t <- top250web %>%
html_nodes("feat-h2") %>%
html_text()
t <- 20places %>%
html_nodes("feat-h2") %>%
html_text()
twentyplaces <- read_html("http://coolmaterial.com/feature/bucket-list-breweries-20-u-s-breweries-you-should-visit-once/")
t <- twentyplace %>%
html_nodes("feat-h2") %>%
html_text()
t <- twentyplaces %>%
html_nodes("feat-h2") %>%
html_text()
t
ttwentyplaces
twentplaces
twentyplaces
t <- twentyplaces %>%
html_nodes("feat-h2")
top250web
t <- twentyplaces %>%
html_nodes("feat-h2") %>%
html_text()
t <- twentyplaces %>%
html_nodes("a href") %>%
html_text()
t <- twentyplaces %>%
html_nodes("body") %>%
html_text()
t <- twentyplaces %>%
html_nodes("h2") %>%
html_text()
t <- as.data.frame(t)
View(t)
Encoding(t) <- "UTF-8"
Encoding(t[,1]) <- "UTF-8"
t[,1] <- as.character(t[,1])
Encoding(t[,1]) <- "UTF-8"
getUrladdr <- function(brewery,sensor = "false") {
root <- "http://beermapping.com/webservice/locquery/"
bmapikey <- "b110d4b01e66ce5aaf3452736aaa1f88"
u <- paste0(root,bmapikey,"/",brewery)
return(URLencode(u))
}
Breweries <- t[,1]
Brewaddr <- as.data.frame(matrix(,nrow = 0, ncol = 10))
for (x in Breweries) {
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
x <- data.frame(BMid = xpathSApply(t, "//location//id", xmlValue),
name = xpathSApply(t, "//location//name", xmlValue),
status = xpathSApply(t, "//location//status", xmlValue),
street = xpathSApply(t, "//location//street", xmlValue),
city = xpathSApply(t, "//location//city", xmlValue),
state = xpathSApply(t, "//location//state", xmlValue),
zip = xpathSApply(t, "//location//zip", xmlValue),
country = xpathSApply(t, "//location//country", xmlValue),
phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,x)
}
rm(x,e,t)
Brewaddr[,1] <- as.numeric(as.character(Brewaddr[,1]))
Brewaddr[,10] <- as.numeric(as.character(Brewaddr[,10]))
View(Brewaddr)
Brewaddr <- Brewaddr[!(Brewaddr[,1]==0),]
Brewaddr <- unique(Brewaddr[,1])
t <- twentyplaces %>%
html_nodes("h2") %>%
html_text()
Encoding(t) <- "UTF-8"
t <- as.data.frame(t)
y <-t
Breweries <- y[,1]
Brewaddr <- as.data.frame(matrix(,nrow = 0, ncol = 10))
library(httr)
for (x in Breweries) {
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
x <- data.frame(BMid = xpathSApply(t, "//location//id", xmlValue),
name = xpathSApply(t, "//location//name", xmlValue),
status = xpathSApply(t, "//location//status", xmlValue),
street = xpathSApply(t, "//location//street", xmlValue),
city = xpathSApply(t, "//location//city", xmlValue),
state = xpathSApply(t, "//location//state", xmlValue),
zip = xpathSApply(t, "//location//zip", xmlValue),
country = xpathSApply(t, "//location//country", xmlValue),
phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,x)
}
rm(x,e,t)
u <- unique(Brewaddr[,2])
u
y
Breweries <- substr(y[2,1],1,5)
for (x in Breweries) {
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(BMid = xpathSApply(t, "//location//id", xmlValue),
name = xpathSApply(t, "//location//name", xmlValue),
status = xpathSApply(t, "//location//status", xmlValue),
street = xpathSApply(t, "//location//street", xmlValue),
city = xpathSApply(t, "//location//city", xmlValue),
state = xpathSApply(t, "//location//state", xmlValue),
zip = xpathSApply(t, "//location//zip", xmlValue),
country = xpathSApply(t, "//location//country", xmlValue),
phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,g)
}
Brewaddr <- as.data.frame(matrix(,nrow = 0, ncol = 10))
for (x in Breweries) {
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(BMid = xpathSApply(t, "//location//id", xmlValue),
name = xpathSApply(t, "//location//name", xmlValue),
status = xpathSApply(t, "//location//status", xmlValue),
street = xpathSApply(t, "//location//street", xmlValue),
city = xpathSApply(t, "//location//city", xmlValue),
state = xpathSApply(t, "//location//state", xmlValue),
zip = xpathSApply(t, "//location//zip", xmlValue),
country = xpathSApply(t, "//location//country", xmlValue),
phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,g)
}
View(Brewaddr)
Breweries <- substr(y[2,1],1,6) ##substr(unique(Top250[,3]),1,20)
###loop it to create a df with brewery and addresses
Brewaddr <- as.data.frame(matrix(,nrow = 0, ncol = 10))
for (x in Breweries) {
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(BMid = xpathSApply(t, "//location//id", xmlValue),
name = xpathSApply(t, "//location//name", xmlValue),
status = xpathSApply(t, "//location//status", xmlValue),
street = xpathSApply(t, "//location//street", xmlValue),
city = xpathSApply(t, "//location//city", xmlValue),
state = xpathSApply(t, "//location//state", xmlValue),
zip = xpathSApply(t, "//location//zip", xmlValue),
country = xpathSApply(t, "//location//country", xmlValue),
phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,g)
}
View(Brewaddr)
Breweries <- substr(y[2,1],1,7) ##substr(unique(Top250[,3]),1,20)
###loop it to create a df with brewery and addresses
Brewaddr <- as.data.frame(matrix(,nrow = 0, ncol = 10))
for (x in Breweries) {
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(BMid = xpathSApply(t, "//location//id", xmlValue),
name = xpathSApply(t, "//location//name", xmlValue),
status = xpathSApply(t, "//location//status", xmlValue),
street = xpathSApply(t, "//location//street", xmlValue),
city = xpathSApply(t, "//location//city", xmlValue),
state = xpathSApply(t, "//location//state", xmlValue),
zip = xpathSApply(t, "//location//zip", xmlValue),
country = xpathSApply(t, "//location//country", xmlValue),
phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,g)
}
View(Brewaddr)
Brewaddr[,1] <- as.numeric(as.character(Brewaddr[,1]))
Brewaddr[,10] <- as.numeric(as.character(Brewaddr[,10]))
Brewaddr <- Brewaddr[!(Brewaddr[,10]==0),]
Breweries <- y[2,1] ##substr(unique(Top250[,3]),1,20)
###loop it to create a df with brewery and addresses
Brewaddr <- as.data.frame(matrix(,nrow = 0, ncol = 10))
for (x in Breweries) {
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(BMid = xpathSApply(t, "//location//id", xmlValue),
name = xpathSApply(t, "//location//name", xmlValue),
status = xpathSApply(t, "//location//status", xmlValue),
street = xpathSApply(t, "//location//street", xmlValue),
city = xpathSApply(t, "//location//city", xmlValue),
state = xpathSApply(t, "//location//state", xmlValue),
zip = xpathSApply(t, "//location//zip", xmlValue),
country = xpathSApply(t, "//location//country", xmlValue),
phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,g)
}
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
y <- trim(y)
rm(x,y,u,t,e,Breweries)
rm(g,r)
r <- twentyplaces %>%
html_nodes("body") %>%
html_text()
r <- twentyplaces %>%
html_nodes("h2") %>%
html_text()
r[2,1]
r[[2]]
Encoding(r) <- "UTF-8"
r <- trim(r)
Breweries <- r
for (x in Breweries) {
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(BMid = xpathSApply(t, "//location//id", xmlValue),
name = xpathSApply(t, "//location//name", xmlValue),
status = xpathSApply(t, "//location//status", xmlValue),
street = xpathSApply(t, "//location//street", xmlValue),
city = xpathSApply(t, "//location//city", xmlValue),
state = xpathSApply(t, "//location//state", xmlValue),
zip = xpathSApply(t, "//location//zip", xmlValue),
country = xpathSApply(t, "//location//country", xmlValue),
phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,g)
}
Brewaddr <- as.data.frame(matrix(,nrow = 0, ncol = 10))
for (x in Breweries) {
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(BMid = xpathSApply(t, "//location//id", xmlValue),
name = xpathSApply(t, "//location//name", xmlValue),
status = xpathSApply(t, "//location//status", xmlValue),
street = xpathSApply(t, "//location//street", xmlValue),
city = xpathSApply(t, "//location//city", xmlValue),
state = xpathSApply(t, "//location//state", xmlValue),
zip = xpathSApply(t, "//location//zip", xmlValue),
country = xpathSApply(t, "//location//country", xmlValue),
phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,g)
}
View(Brewaddr)
j <- unique(Brewaddr[,2])
j
Brewaddr[,1] <- as.numeric(as.character(Brewaddr[,1]))
Brewaddr[,10] <- as.numeric(as.character(Brewaddr[,10]))
Brewaddr[,1] <- as.numeric(as.character(Brewaddr[,1]))
Brewaddr[,10] <- as.numeric(as.character(Brewaddr[,10]))
Brewaddr <- Brewaddr[!(Brewaddr[,10]==0),]
Brewaddr <- Brewaddr[!(Brewaddr[,1]==0),]
Brewaddr <- as.data.frame(matrix(,nrow = 0, ncol = 10))
for (x in Breweries) {
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(BMid = xpathSApply(t, "//location//id", xmlValue),
name = xpathSApply(t, "//location//name", xmlValue),
status = xpathSApply(t, "//location//status", xmlValue),
street = xpathSApply(t, "//location//street", xmlValue),
city = xpathSApply(t, "//location//city", xmlValue),
state = xpathSApply(t, "//location//state", xmlValue),
zip = xpathSApply(t, "//location//zip", xmlValue),
country = xpathSApply(t, "//location//country", xmlValue),
phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,g)
}
rm(g,e,t)
Brewaddr[,1] <- as.numeric(as.character(Brewaddr[,1]))
Brewaddr <- Brewaddr[!(Brewaddr[,1]==0),]
View(Brewaddr)
Brewaddr <- Brewaddr[!(Brewaddr[,3]=="Beer Bar"),]
rownames(Brewaddr) <- 1:27
Brewaddr <- Brewaddr[,c(1,4,9,11,12,13,14,17,18,19,20,23,24,25,26,27)]
Brewaddr <- Brewaddr[c(1,4,9,11,12,13,14,17,18,19,20,23,24,25,26,27),]
Breweries <- r
###loop it to create a df with brewery and addresses
Brewaddr <- as.data.frame(matrix(,nrow = 0, ncol = 10))
for (x in Breweries) {
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(BMid = xpathSApply(t, "//location//id", xmlValue),
name = xpathSApply(t, "//location//name", xmlValue),
status = xpathSApply(t, "//location//status", xmlValue),
street = xpathSApply(t, "//location//street", xmlValue),
city = xpathSApply(t, "//location//city", xmlValue),
state = xpathSApply(t, "//location//state", xmlValue),
zip = xpathSApply(t, "//location//zip", xmlValue),
country = xpathSApply(t, "//location//country", xmlValue),
phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,g)
}
rm(g,e,t)
Brewaddr[,1] <- as.numeric(as.character(Brewaddr[,1]))
Brewaddr <- Brewaddr[!(Brewaddr[,1]==0),]
r
Breweries <- substr(r,1,8)
###loop it to create a df with brewery and addresses
Brewaddr <- as.data.frame(matrix(,nrow = 0, ncol = 10))
for (x in Breweries) {
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(BMid = xpathSApply(t, "//location//id", xmlValue),
name = xpathSApply(t, "//location//name", xmlValue),
status = xpathSApply(t, "//location//status", xmlValue),
street = xpathSApply(t, "//location//street", xmlValue),
city = xpathSApply(t, "//location//city", xmlValue),
state = xpathSApply(t, "//location//state", xmlValue),
zip = xpathSApply(t, "//location//zip", xmlValue),
country = xpathSApply(t, "//location//country", xmlValue),
phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,g)
}
rm(g,e,t)
Brewaddr[,1] <- as.numeric(as.character(Brewaddr[,1]))
Brewaddr <- Brewaddr[!(Brewaddr[,1]==0),]
View(Brewaddr)
Breweries <- substr(r,1,10)
###loop it to create a df with brewery and addresses
Brewaddr <- as.data.frame(matrix(,nrow = 0, ncol = 10))
for (x in Breweries) {
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(BMid = xpathSApply(t, "//location//id", xmlValue),
name = xpathSApply(t, "//location//name", xmlValue),
status = xpathSApply(t, "//location//status", xmlValue),
street = xpathSApply(t, "//location//street", xmlValue),
city = xpathSApply(t, "//location//city", xmlValue),
state = xpathSApply(t, "//location//state", xmlValue),
zip = xpathSApply(t, "//location//zip", xmlValue),
country = xpathSApply(t, "//location//country", xmlValue),
phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,g)
}
rm(g,e,t)
Brewaddr[,1] <- as.numeric(as.character(Brewaddr[,1]))
Brewaddr <- Brewaddr[!(Brewaddr[,1]==0),]
View(Brewaddr)
rownames(Brewaddr) <- 1:49
Brewaddr <- Brewaddr[c(1,4,14,15,17,21,25,26,29,31,33,35,36
,40,41,43,46,49),]
rownames(Brewaddr) <- 1:18
Breweries <- substr(r,1,10)
r <- gsub("3", "Three",r)
r
Breweries <- substr(r,1,10)
Brewaddr <- as.data.frame(matrix(,nrow = 0, ncol = 10))
for (x in Breweries) {
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(BMid = xpathSApply(t, "//location//id", xmlValue),
name = xpathSApply(t, "//location//name", xmlValue),
status = xpathSApply(t, "//location//status", xmlValue),
street = xpathSApply(t, "//location//street", xmlValue),
city = xpathSApply(t, "//location//city", xmlValue),
state = xpathSApply(t, "//location//state", xmlValue),
zip = xpathSApply(t, "//location//zip", xmlValue),
country = xpathSApply(t, "//location//country", xmlValue),
phone = xpathSApply(t, "//location//phone", xmlValue),
rating= xpathSApply(t, "//location//overall", xmlValue)
)
Brewaddr <- rbind(Brewaddr,g)
}
rm(g,e,t)
Brewaddr[,1] <- as.numeric(as.character(Brewaddr[,1]))
Brewaddr <- Brewaddr[!(Brewaddr[,1]==0),]
rownames(Brewaddr) <- 1:50
Brewaddr <- Brewaddr[c(1,4,14,15,17,21,25,26,29,31,33,35,36
,40,41,43,46,49,50),]
rownames(Brewaddr) <- 1:19
View(Brewaddr)
d <- as.data.frame(c("monhegan Brewing","Brewpub","address"))
d
d <- rbind(Brewaddr,d)
d <- c("monhegan Brewing","Brewpub","address")
d <- rbind(Brewaddr,d)
View(d)
d <- c("Monhegan Brewing Company","Brewpub","1 Boody Lane","Monhegan","ME","04852","United States","(207) 975-3958")
d <- c("NA",Monhegan Brewing Company","Brewpub","1 Boody Lane","Monhegan","ME","04852","United States","(207) 975-3958")
d <- c("NA","Monhegan Brewing Company","Brewpub","1 Boody Lane","Monhegan","ME","04852","United States","(207) 975-3958")
install.packages("miscTools")
library(miscTools)
f <- Brewaddr
g <- insertRow(f,20,d,rName = "20")
f <- as.matrix(f)
g <- insertRow(f,20,d,rName = "20")
d <- c("NA","Monhegan Brewing Company","Brewpub","1 Boody Lane","Monhegan","ME","04852","United States","(207) 975-3958","0")
f <- Brewaddr
f <- as.matrix(f)
g <- insertRow(f,20,d,rName = "20")
View(g)
Brewaddr <- as.data.frame(insertRow(as.matrix(Brewaddr),20,d,rName = "20"))
rm(f,g)
getUrlmap <- function(id,sensor = "false") {
root <- "http://beermapping.com/webservice/locmap/"
bmapikey <- "b110d4b01e66ce5aaf3452736aaa1f88"
u <- paste0(root,bmapikey,"/",id)
return(URLencode(u))
}
View(Brewaddr)
Brewmap <- as.data.frame(matrix(,nrow = 0, ncol = 10))
Brewids <- 55
x <- 55
e <- getUrladdr(x)
t <- content(GET(e, accept_xml()))
e <- getUrlmap(x)
t <- content(GET(e, accept_xml()))
t
for (x in Brewids) {
e <- getUrlmap(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(name = xpathSApply(t, "//location//name", xmlValue),
lat = xpathSApply(t, "//location//lat", xmlValue),
lng = xpathSApply(t, "//location//lng", xmlValue),
city = xpathSApply(t, "//location//altmap", xmlValue),
)
Brewmap <- rbind(Brewmap,g)
}
for (x in Brewids) {
e <- getUrlmap(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(name = xpathSApply(t, "//location//name", xmlValue),
lat = xpathSApply(t, "//location//lat", xmlValue),
lng = xpathSApply(t, "//location//lng", xmlValue),
city = xpathSApply(t, "//location//altmap", xmlValue)
)
Brewmap <- rbind(Brewmap,g)
}
View(Brewmap)
Brewids <- Brewaddr[,1]
Brewmap <- as.data.frame(matrix(,nrow = 0, ncol = 10))
for (x in Brewids) {
e <- getUrlmap(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(name = xpathSApply(t, "//location//name", xmlValue),
lat = xpathSApply(t, "//location//lat", xmlValue),
lng = xpathSApply(t, "//location//lng", xmlValue),
city = xpathSApply(t, "//location//altmap", xmlValue)
)
Brewmap <- rbind(Brewmap,g)
}
View(Brewmap)
library(rvest)
library(magrittr)
library(plyr)
library(stringr)
g <- merge(Brewaddr,Brewmap)
View(g)
g <- merge(Brewaddr,Brewmap, all.x = all)
g <- merge(Brewaddr,Brewmap, all.x = TRUE)
View(g)
for (x in Brewids) {
e <- getUrlmap(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(name = xpathSApply(t, "//location//name", xmlValue),
lat = xpathSApply(t, "//location//lat", xmlValue),
lng = xpathSApply(t, "//location//lng", xmlValue)
)
Brewmap <- rbind(Brewmap,g)
}
Brewmap <- as.data.frame(matrix(,nrow = 0, ncol = 3))
for (x in Brewids) {
e <- getUrlmap(x)
t <- content(GET(e, accept_xml()))
g <- data.frame(name = xpathSApply(t, "//location//name", xmlValue),
lat = xpathSApply(t, "//location//lat", xmlValue),
lng = xpathSApply(t, "//location//lng", xmlValue)
)
Brewmap <- rbind(Brewmap,g)
}
rm(g,e,t)
View(Brewmap)
g <- merge(Brewaddr,Brewmap, all.x = TRUE)
View(g)
Brewfull <- merge(Brewaddr,Brewmap, all.x = TRUE)
View(Brewfull)
Brewfull[4,11] <- 42.6269
Brewfull[4,12] <- -74.9453
Brewfull[4,12] <- "-74.9453"
View(Brewfull)
Brewfull[4,11] <- "42.6269"
Brewfull[,11] <- as.numeric(as.character(Brewfull[,11]))
Brewfull[,12] <- as.numeric(as.character(Brewfull[,12]))
Brewfull[4,11] <- "42.6269"
Brewfull[4,12] <- "-74.9453"
Brewfull[7,11] <- "38.770622"
Brewfull[7,12] <- "-75.310893"
Brewfull[8,11] <- "44.6072776"
Brewfull[8,12] <- "-72.2642255"
Brewfull[10,11] <- "20.749519"
Brewfull[10,12] <- "-156.4395347"
Brewfull[11,11] <- "43.8812802"
Brewfull[11,12] <- "-69.635781"
Brewfull[15,11] <- "21.2022297"
Brewfull[15,12] <- "-116.2963116"
Brewfull[19,11] <- "42.0929348"
Brewfull[19,12] <- "-72.290422"
Brewfull[20,11] <- "40.6917443"
Brewfull[20,12] <- "-76.2090246"
write.csv(Brewfull,"20 Bucket List Breweries.csv")
